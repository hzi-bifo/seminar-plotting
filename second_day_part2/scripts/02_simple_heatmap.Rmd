---
title: "Day 2 â€“ 02 Simple Heatmap"
author: "Seminar plotting walk-through"
output:
  html_document:
    toc: false
---

A minimal example that turns the prepared wide table (`dataset1_subset.csv`)
into a heatmap with practically no extra formatting. This is the first step
before moving on to the fully annotated version in `03_heatmap_annotations.Rmd`.

## 1. Packages and paths

```{r setup, message=FALSE, warning=FALSE}
library(ComplexHeatmap)
subset_path <- file.path('..', 'data', 'dataset1_subset.csv')
long_path <- file.path('..', 'data', 'dataset1_subset_long.csv')
pdf_path <- file.path('..', 'pdf', 'dataset1_heatmap_basic.pdf')
target_group <- 'Control'  # change this to view other treatment groups
```

## 2. Load, subset by treatment group, and convert to a matrix

```{r matrix}
wide_df <- read.csv(subset_path, check.names = FALSE, stringsAsFactors = FALSE)
long_df <- read.csv(long_path, check.names = FALSE, stringsAsFactors = FALSE)
sample_meta <- unique(long_df[, c('mouse_id', 'day', 'treatment_group')])
sample_meta$sample_id <- paste(sample_meta$mouse_id, sample_meta$day, sep = '-')
sample_cols <- setdiff(names(wide_df), c('Genome', 'snp_id', 'Position'))
keep_cols <- intersect(sample_cols, sample_meta$sample_id[sample_meta$treatment_group == target_group])
if (!length(keep_cols)) {
  stop('No samples found for treatment group: ', target_group)
}
heatmap_matrix <- as.matrix(wide_df[, keep_cols])
mode(heatmap_matrix) <- 'numeric'
rownames(heatmap_matrix) <- paste(wide_df$Genome, wide_df$snp_id, sep = ' | ')
colnames(heatmap_matrix) <- keep_cols
```

## 3. Draw the simplest possible heatmap

```{r draw, fig.width=9, fig.height=6}
ht <- Heatmap(
  heatmap_matrix,
  name = 'value',
  cluster_rows = FALSE,
  cluster_columns = FALSE,
  show_row_names = FALSE,
  show_column_names = TRUE
)

draw(ht)
```

## 4. Optional: save to PDF

```{r export, eval=FALSE}
pdf(pdf_path, width = 10, height = 7)
draw(ht)
dev.off()
cat('Saved basic heatmap to', pdf_path, '\n')
```

Ready for more control? Open `03_heatmap_annotations.Rmd` to add ordering,
annotations, and publication polish.
